!function(){function e(t={}){var s;return s=class extends(t.native?Object.getPrototypeOf(document.createElement(t.native)).constructor:HTMLElement){constructor(){super(),this._data||(this._data={}),n("onConstruct",this)}},s.options={},s.getOptions=function(e){return this.options[e]||(this.options[e]=Object.assign({},this.__proto__.options?this.__proto__.options[e]:{}))},s.getOptions("extensions"),s.getOptions("pseudos"),s.extensions=function(...e){var t=this.getOptions("extensions");return e.reduce((e,s)=>{var o,r=e;return t[s.name]||("string"==typeof s?o=l.extensions[s].mixin:(o=s.mixin,t[s.name]=s),o&&n("onParse",r=o(e))),r},this)},s.as=function(t){return e({native:t})},s.extensions("attr","event","template")}function t(e,t,n,s){return function(){var o={fn:n,args:t,detail:s},r=e.onInvoke(this,o,...arguments);return null===r||!1===r?r:o.fn.apply(this,r instanceof Array?r:arguments)}}function n(e,n){switch(e){case"onParse":var o={},a=s(n),c=n.getOptions("extensions"),p=n._processedExtensions=new Map;for(let e in a){let s,u,d=[],f=[],m=a[e],v=n._pseudos||l.pseudos;e.replace(r,function(){d.unshift(arguments)}),d.forEach(e=>(function(e,o,r,a,d){if(s=o||s,d)var h=d.split(i);if("::"==r)f=h||[],u=c[a]||l.extensions[a],p.get(u)||p.set(u,[]);else if(!o){let e=v[a];if(e)for(let o in m){let r=m[o];"function"==typeof r&&e.onInvoke&&(r=m[o]=t(e,h,r),e.onParse&&e.onParse(n,s,h,r))}}}).apply(null,e));let h;if(u&&(p.get(u).push([s,f,m]),u.onParse&&(h=u.onParse(n,s,f,m,e))),s){if(!1!==h){let e=o[s]||(o[s]={});for(let t in m)e[t]=m[t]}}else delete n.prototype[e]}for(let e of p.keys())e.onCompiled&&e.onCompiled(n,o);Object.defineProperties(n.prototype,o);break;case"onConstruct":p=n.constructor._processedExtensions;for(let[e,t]of p)e.onConstruct&&t.forEach(t=>e.onConstruct(n,...t))}}function s(e){var t={},n=e.prototype;return Object.getOwnPropertyNames(n).forEach(e=>{t[e]=Object.getOwnPropertyDescriptor(n,e)}),t}var o=document.documentElement;Element.prototype.matches||(Element.prototype.matches=o.webkitMatchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector);var r=/(\w+)|(::|:)(\w+)(?:\((.+?(?=\)))\))?/g,a=/(\w+)|:(\w+)\((.+?(?=\)?))?|:(\w+)/g,i=/,\s*/,c=document.createRange(),l={events:{},pseudos:{delegate:{onInvoke:function(e,t,n){for(var s,o=n.target,r=n.currentTarget;!s&&o&&o!=r;)o.tagName&&o.matches(t.args)&&(s=o),o=o.parentNode;if(!s&&r.tagName&&r.matches(t.args)&&(s=r),!s)return null;t.fn=t.fn.bind(s)}}},extensions:{attr:{mixin:e=>class extends e{attributeChangedCallback(e,t,n){var s=this.constructor.getOptions("attributes")[e];s&&s.set&&!s._skip&&(s._skip=!0,s.set.call(this,n),s._skip=null)}},types:{boolean:{set:function(e,t){t||""===t?this.setAttribute(e,""):this.removeAttribute(e)},get:function(e){return this.hasAttribute(e)}}},onParse(e,t,n,s,o){if(s.value)throw'Attribute accessor "'+t+'" was declared as a value, but must be declared as get or set';e.getOptions("attributes")[t]=s;var r=this.types[n[0]]||{};let a=s.set,i=r.set||HTMLElement.prototype.setAttribute;s.set=function(e){if(!s._skip){s._skip=!0;var n;a&&(n=a.call(this,e)),i.call(this,t,void 0===n?e:n),s._skip=null}};let c=s.get,l=r.get||HTMLElement.prototype.getAttribute;s.get=function(){var e,n=l.call(this,t);return c&&(e=c.call(this,n)),void 0===e?n:e},delete e.prototype[o]},onCompiled(e){e.observedAttributes=Object.keys(e.getOptions("attributes")).concat(e.observedAttributes||[])}},event:{onParse:(e,t,n,s,o)=>(delete e.prototype[o],!1),onConstruct(e,t,n,s){l.addEvent(e,t,s.value)}},template:{mixin:e=>class extends e{set"template::attr"(e){this.render(e)}get templates(){return this.constructor.getOptions("templates")}render(e){var t=e||"default",n=this.templates[t];if(!n)throw new ReferenceError('Template "'+t+'" is undefined');this.innerHTML="",this.appendChild(c.createContextualFragment(n.call(this)))}},onParse:(e,t,n,s)=>(e.getOptions("templates")[t||"default"]=s.value,!1),onConstruct(e,t,n){JSON.parse(n[0]||!1)&&e.render(t)}}},create(e,t){var s=t||e;return n("onParse",s),t&&e&&customElements.define(e,s),s},register(e,t){customElements.define(e,t)},addEvent(e,n,s,o){var r,c=s,p={data:{},capture:o},u=e.constructor.getOptions("pseudos");n.replace(a,(n,s,o,a,d)=>{if(s)r=s;else{var f=u[f=o||d]||l.pseudos[f],m=a?a.split(i):[];c=t(f,m,c,p),f.onParse&&f.onParse(e,r,m,c,p)}}),e.addEventListener(r,c,o),p.type=r,p.listener=c;var d=e.constructor.getOptions("events")[r]||l.events[r];if(d){var f=function(e){new Promise((t,n)=>{d.onFilter(this,e,p,t,n)}).then(()=>{l.fireEvent(e.target,r)})};p.attached=d.attach.map(t=>l.addEvent(e,t,f,!0)),d.onAdd&&d.onAdd(e,p)}return p},removeEvent(e,t){e.removeEventListener(t.type,t.listener,t.capture);var n=e.constructor.getOptions("events")[t.type]||l.events[t.type];n&&n.onRemove&&n.onRemove(e,t),t.attached&&t.attached.forEach(n=>{l.removeEvent(e,t)})},fireEvent(e,t,n={}){let s=Object.assign({bubbles:!0,cancelable:!0},n);e.dispatchEvent(new CustomEvent(t,s))}};XTagElement=e(),"function"==typeof define&&define.amd?(define(l),define(XTagElement)):"undefined"!=typeof module&&module.exports?module.exports={xtag:l,XTagElement:XTagElement}:(window.xtag=l,window.XTagElement=XTagElement)}();